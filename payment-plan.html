<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pricing Plans</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="user_styles/payment-plan.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet" />

</head>

<body class="relative">

<nav class="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-40 text-white shadow-md px-4 py-3 border-b border-white/20">
    <div class="flex items-center justify-between w-full">

        <div class="text-left ml-2 sm:ml-4 select-none">
       <span class="nav-logo-text text-[1.8em] font-bold tracking-[3px] text-transparent bg-clip-text animate-softPulse drop-shadow-md"
             style="
              font-family: 'Orbitron', sans-serif;
              background: linear-gradient(135deg, #37a199, #8f2424, #c68711);
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
              text-fill-color: transparent;
              text-shadow: 0 0 10px rgb(38, 52, 57), 0 0 20px rgba(45, 67, 81, 0.3);
            ">
            CINE<span class="opacity-80">-</span>LIGHT
          </span>
        </div>

    </div>
</nav>

<div class="fixed inset-0 bg-cover bg-center -z-10" style="background-image: url('assets/images/Airbrush-OBJECT-REMOVER-1755543227723.jpg');" aria-hidden="true"></div>
<div class="fixed inset-0 bg-black bg-opacity-50 -z-10"></div>

<section class="custom-pricing-section relative pt-32 pb-12 px-4 mx-auto max-w-screen-xl lg:py-20 lg:px-6">
    <div class="relative mx-auto max-w-screen-md text-center mt-7 lg:mb-12 text-white">
        <h2 class="mb-4 text-6xl tracking-tight font-extrabold custom-title">Select your plan</h2>
    </div>

    <div id="pricing-carousel" class="flex justify-center items-center gap-6 flex-wrap lg:flex-nowrap">


        <div class="pricing-card active-card transition-all duration-300 ease-in-out cursor-pointer" onclick="setActiveCard(0)">
            <h3 class="mb-4 text-2xl font-semibold">Enterprise</h3>
            <div class="flex justify-center items-baseline my-3">
                <span class="mr-2 text-5xl font-extrabold">$5</span>
                <span class="text-gray-300">/month</span>
            </div>
            <ul role="list" class="mt-5 mb-8 space-y-4 text-center text-sm sm:text-base">
                <li>✅ Access to All movies</li>
                <li>✅ Can download any movie</li>
                <li>✅ Supports up to 2K resolution</li>
                <li>❌ Cannot watch live content</li>
            </ul>
            <a href="javascript:void(0)" onclick="openPaymentPopup('Enterprise', 5)"
               class="block w-[85%] mx-auto text-white bg-gray-700 hover:bg-gray-800 font-medium rounded-lg text-sm px-5 py-3 text-center mt-4">
                Get started
            </a>
        </div>

        <div class="pricing-card  shrink-card transition-all duration-300 ease-in-out cursor-pointer" onclick="setActiveCard(1)" >
            <h3 class="mb-4 text-2xl font-semibold">Intermediate</h3>
            <div class="flex justify-center items-baseline my-3">
                <span class="mr-2 text-5xl font-extrabold">10$</span>
                <span class="text-gray-300">/month</span>
            </div>
            <ul role="list" class="mt-5 mb-8 space-y-4 text-center text-sm sm:text-base">
                <li>✅ Access to All movies</li>
                <li>✅ Can watch live content</li>
                <li>✅ Can download any movie</li>
                <li>✅ Supports up to 4K resolution</li>
            </ul>
            <a href="javascript:void(0)"
               onclick="openPaymentPopup('Intermediate', 10)"
               class="block w-[85%] mx-auto text-white bg-gray-700 hover:bg-gray-800 font-medium rounded-lg text-sm px-5 py-3 text-center mt-4">
                Get started
            </a>
        </div>

    </div>
</section>

<div id="payment-popup" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-md flex justify-center items-center hidden z-50">
    <div class="bg-neutral-700 text-white rounded-lg p-6 w-full max-w-md relative shadow-2xl border border-gray-300">
        <h2 class="text-3xl font-bold mb-6 text-center text-white"
            style="text-shadow: 2px 2px 4px rgba(255, 0, 0, 0.7);">
            Confirm Your Plan
        </h2>

        <div class="space-y-3 text-base">
            <div><strong>Name:</strong> <span id="userName" class="text-gray-300">Loading...</span></div>
            <div><strong>Email:</strong> <span id="userEmail" class="text-gray-300">Loading...</span></div>
            <div><strong>Plan:</strong> <span id="planName" class="text-gray-300">Loading...</span></div>
            <div><strong>Date:</strong> <span id="purchaseDate" class="text-gray-300">Loading...</span></div>
        </div>

        <div class="flex flex-col sm:flex-row justify-between gap-4 mt-8">
            <button onclick="closePopup()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded flex items-center justify-center gap-2">
                Close
            </button>

            <button onclick="confirmPayment()" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded">
                Confirm & Pay
            </button>
        </div>
    </div>
</div>

<footer class="custom-glass-footer text-white">
    <div class="max-w-7xl mx-auto px-12 py-10 grid grid-cols-1 md:grid-cols-4 gap-2 place-items-center text-center">
        <div class="space-y-2 pb-2">
            <h2 class="foot-head">CINE-LIGHT</h2>
            <p class="foot-sub">Delivering blockbuster moments, one reel at a time, inspiring stories that captivate the soul.</p>
        </div>

        <div class="space-y-2 pt-1.7">
            <h3 class="movie">Movies</h3>
            <ul class="movie-sub space-y-1">
                <li><a href="#" class="hover:underline">Action</a></li>
                <li><a href="#" class="hover:underline">Horror</a></li>
                <li><a href="#" class="hover:underline">Sci-Fic</a></li>
                <li><a href="#" class="hover:underline">Romance</a></li>
            </ul>
        </div>

        <div class="space-y-2 pb-5">
            <h3 class="company">Company</h3>
            <ul class="company-sub space-y-1">
                <li><a href="#" class="hover:underline">Why Us</a></li>
                <li><a href="#" class="hover:underline">FAQ's</a></li>
            </ul>
        </div>

        <div class="space-y-3" style="padding-bottom: 3.25rem;">
            <h2 class="fallow">Follow Us</h2>
            <div class="flex justify-center gap-4">
                <a href="#">
                    <img src="https://cdn-icons-png.flaticon.com/128/5968/5968764.png" class="w-9 h-9 rounded-full" alt="Facebook" />
                </a>
                <a href="#">
                    <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" class="w-9 h-9 rounded-full" alt="Instagram" />
                </a>
                <a href="#">
                    <img src="https://cdn-icons-png.flaticon.com/512/5968/5968804.png" class="w-9 h-9 rounded-full" alt="Telegram" />
                </a>
            </div>

        </div>
    </div>
    <div class="text-center border-t border-gray-300/30 py-4 copy">
        © 2025 <span class="sin">CINE-LIGHT</span>. All rights reserved.
    </div>
</footer>

<script src="user_script/payment-plan.js" type="module"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>
<script src="https://www.payhere.lk/lib/payhere.js"></script>

<!-- Firebase v8 scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>


<script>

    // Firebase config (you already have this)
    const firebaseConfig = {
        apiKey: "AIzaSyCNH38ylbzfIORN0wmDoizj_eWKunQ1uAQ",
        authDomain: "my-first-app-6a293.firebaseapp.com",
        databaseURL: "https://my-first-app-6a293-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "my-first-app-6a293",
        storageBucket: "my-first-app-6a293.firebasestorage.app",
        messagingSenderId: "599546991663",
        appId: "1:599546991663:web:b07d25c55f1d00c06722da",
        measurementId: "G-5EVKKY7KLP"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    function openPaymentPopup(plan, price) {
        const popup = document.getElementById("payment-popup");
        popup.classList.remove("hidden");

        // ✅ Only set the plan name (no price!)
        document.getElementById("planName").textContent = plan;

        document.getElementById("purchaseDate").textContent = new Date().toLocaleDateString();

        auth.onAuthStateChanged((user) => {
            if (user) {
                document.getElementById("userName").textContent = user.displayName || "Anonymous";
                document.getElementById("userEmail").textContent = user.email;
            } else {
                document.getElementById("userName").textContent = "Not logged in";
                document.getElementById("userEmail").textContent = "-";
            }
        });
    }

    function closePopup() {
        document.getElementById("payment-popup").classList.add("hidden");
    }

    function confirmPayment() {
        const user = auth.currentUser;
        if (!user) {
            alert("User not logged in.");
            return;
        }

        const name = user.displayName || "Anonymous";
        const email = user.email;
        const plan = document.getElementById("planName").textContent;
        const date = document.getElementById("purchaseDate").textContent;

        // Send payment info to backend
        fetch("http://localhost:8080/api/payments", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                name: name,
                email: email,
                plan: plan,
                date: date
            })
        }).then(res => {
            if (!res.ok) throw new Error("Failed to save payment");
            return res.json();
        }).then(data => {
            alert("Payment confirmed & saved to backend!");
            closePopup();
            window.location.href = "/index.html";
        }).catch(err => {
            console.error("Error:", err);
            alert("Failed to save payment.");
        });
    }


</script>

<script>
    // Current page URL (payment page)
    const currentPageURL = "/AAD-FINAL/AAD-FINAL-PROJECT/payment-plan.html";

    // Push a new history state to "lock" the user here
    history.pushState(null, null, location.href);

    // Listen for back/forward navigation
    window.addEventListener("popstate", function (event) {
        // Whenever the user tries to navigate back, force redirect to payment page
        location.replace(currentPageURL);
    });


    // Function to toggle active card on click
    function setActiveCard(index) {
        const cards = document.querySelectorAll('.pricing-card');

        cards.forEach((card, i) => {
            if (i === index) {
                card.classList.add('active-card');
                card.classList.remove('shrink-card');
            } else {
                card.classList.remove('active-card');
                card.classList.add('shrink-card');
            }
        });
    }



</script>



</body>
</html>
