<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CINE-LIGHT</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="user_styles/all-movie.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet" />

    <style>
        html, body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #000000e6, #2c2b2b) !important;
        }

        @media (max-width: 425px) {
            .nav-links {
                display: none;
            }

            .dropdown {
                display: block;
                text-align: left;
                position: absolute;
                top: 48px;
                left: 6px;
                width: 200px;
                background-color: rgba(0, 0, 0, 0.85);
                border-radius: 8px;
                padding: 12px 16px;
                z-index: 999;
                border: 1px solid rgba(251, 250, 250, 0.3);
            }

            .dropdown a {
                display: block;
                padding: 10px 12px;
                border-radius: 6px;
                color: white;
                transition: background-color 0.2s, color 0.2s;
            }

            .dropdown a:hover {
                background-color: #a1a1a1;
                color: black;
            }

            .nav-logo-text {
                font-size: 1.34em !important;
            }
        }

        @media (width: 1024px) {
            .movie {
                grid-template-columns: repeat(3, 1fr) !important;
            }
        }

        @media (max-width: 375px) {
            .nav-logo-text {
                font-size: 1.22em !important;
            }

            .nav-links {
                display: none;
            }

            .dropdown {
                display: block;
                text-align: left;
                position: absolute;
                top: 48px;
                left: 6px;
                width: 200px;
                background-color: rgba(0, 0, 0, 0.85);
                border-radius: 8px;
                padding: 12px 16px;
                z-index: 999;
                border: 1px solid rgba(251, 250, 250, 0.3);
            }

            .dropdown a {
                display: block;
                padding: 10px 12px;
                border-radius: 6px;
                color: white;
                transition: background-color 0.2s, color 0.2s;
            }

            .dropdown a:hover {
                background-color: #a1a1a1;
                color: black;
            }
        }

        @media (max-width: 320px) {
            .nav-logo-text {
                font-size: 1.08em !important;
            }

            .nav-links {
                display: none;
            }

            .dropdown {
                display: block;
                text-align: left;
                position: absolute;
                top: 48px;
                left: 6px;
                width: 200px;
                background-color: rgba(0, 0, 0, 0.85);
                border-radius: 8px;
                padding: 12px 16px;
                z-index: 999;
                border: 1px solid rgba(251, 250, 250, 0.3);
            }

            .dropdown a {
                display: block;
                padding: 10px 12px;
                border-radius: 6px;
                color: white;
                transition: background-color 0.2s, color 0.2s;
            }

            .dropdown a:hover {
                background-color: #a1a1a1;
                color: black;
            }
        }

        .nav-logo-text {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, #37a199, #8f2424, #c68711);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-fill-color: transparent;
            text-shadow: 0 0 10px rgb(38, 52, 57), 0 0 20px rgba(45, 67, 81, 0.3);
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .all-movie-header {
            font-size: 3rem !important;
            font-weight: 600 !important;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 2px !important;

            /* Remove gradient background and clipping */
            background: none !important;
            -webkit-background-clip: unset !important;
            -webkit-text-fill-color: unset !important;
            background-clip: unset !important;
            text-fill-color: unset !important;
            animation: none !important;

            /* Set solid white color */
            color: white !important;

            /* Combined white and red text shadow */
            text-shadow:
                    0 0 3px rgba(255, 255, 255, 0.5),
                    0 0 6px rgba(255, 255, 255, 0.3),
                    0 0 5px rgba(255, 0, 0, 0.7),
                    0 0 10px rgba(255, 0, 0, 0.7);
        }

        @keyframes glowShift {
            0% { background-position: 0% center; }
            50% { background-position: 100% center; }
            100% { background-position: 0% center; }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
                box-shadow: 0 10px 13px rgba(198,194,194,0.4);
            }
            50% {
                transform: translateY(-10px);
                box-shadow: 0 14px 16px rgba(198,194,194,0.6);
            }
        }

        .movie-card-animated {
            animation: float 6s ease-in-out infinite;
            will-change: transform;
        }

        .movie-card-animated:nth-child(odd) {
            animation-delay: 0s;
        }
        .movie-card-animated:nth-child(even) {
            animation-delay: 3s;
        }

        @media (max-width: 425px) {
            .movie-card-animated {
                padding: 1rem !important;
                border-width: 1.5px !important;
                font-size: 0.9rem !important;
                width: 80% !important; /* Reduce width */
                margin-left: auto !important; /* Center horizontally */
                margin-right: auto !important;
                height: 330px !important;

            }
            .movie-card-animated img {
                height: 200px !important;
            }
            .movie-card-animated h3 {
                font-size: 1.25rem !important;
            }
            .movie-card-animated p {
                font-size: 0.89rem !important;
            }
            .all-movie-header{
                font-size: 2.3rem !important;
            }
        }

        @media (max-width: 375px) {
            .movie-card-animated {
                padding: 0.75rem !important;
                font-size: 0.85rem !important;
                width: 83% !important; /* Reduce width */
                margin-left: auto !important; /* Center horizontally */
                margin-right: auto !important;
                height: 300px !important;

            }
            .movie-card-animated img {
                height: 180px !important;
            }
            .movie-card-animated h3 {
                font-size: 1.2rem !important;
            }
            .movie-card-animated p {
                font-size: 0.84rem !important;
            }
            .all-movie-header{
                font-size: 2rem !important;
            }
        }

        @media (max-width: 320px) {
            .movie-card-animated {
                padding: 0.5rem !important;
                font-size: 0.8rem !important;
                width: 90% !important;
                margin-left: auto !important;
                margin-right: auto !important;
                height: 300px !important;
            }
            .movie-card-animated img {
                height: 180px !important;
            }
            .movie-card-animated h3 {
                font-size: 1.18rem !important;
            }
            .movie-card-animated p {
                font-size: 0.8rem !important;
            }
            .all-movie-header{
                font-size: 1.6rem !important;
            }
        }


    </style>
</head>
<body>

<nav class="fixed top-0 left-0 right-0 z-50 text-white shadow-md px-4 py-3 border-b border-white/20 backdrop-blur-md bg-black/40">
    <div class="w-full relative sm:grid sm:grid-cols-3 items-center">
        <div class="flex sm:hidden justify-between items-center w-full relative">
            <button id="dropdownToggle" class="text-white text-xl ml-2" aria-label="Toggle menu">
                <i id="dropdownIcon" class="fas fa-bars"></i>
            </button>

            <div class="absolute left-1/2 transform -translate-x-1/2 select-none">
                <span class="nav-logo-text text-[1.8em] font-bold tracking-[3px] drop-shadow-md">
                    CINE<span class="opacity-80">-</span>LIGHT
                </span>
            </div>

            <a href="index.html" class="text-gray-200 text-xl hover:text-gray-400 transition mr-3">
                <i class="fas fa-house" style="filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.6));"></i>
            </a>
        </div>

        <div class="hidden sm:flex justify-start ml-4">
            <span class="nav-logo-text text-[1.8em] font-bold tracking-[3px] drop-shadow-md select-none">
                CINE<span class="opacity-80">-</span>LIGHT
            </span>
        </div>

        <div class="hidden sm:flex justify-center nav-links gap-8 text-lg font-semibold items-center">
            <a href="horror.html"
               class="flex items-center gap-2 border-b-2 border-transparent transition duration-300 hover:text-red-400 hover:border-red-600 hover:scale-105 hover:bg-black/10 px-2 py-1 rounded-md">
                <i class="fas fa-mask"></i> Horror
            </a>

            <a href="comedy.html"
               class="flex items-center gap-2 border-b-2 border-transparent transition duration-300 hover:text-yellow-300 hover:border-yellow-400 hover:scale-105 hover:bg-black/10 px-2 py-1 rounded-md">
                <i class="fas fa-theater-masks"></i> Comedy
            </a>

            <a href="action.html"
               class="flex items-center gap-2 border-b-2 border-transparent transition duration-300 hover:text-blue-400 hover:border-blue-500 hover:scale-105 hover:bg-black/10 px-2 py-1 rounded-md">
                <i class="fas fa-person-running"></i> Action
            </a>

            <a href="fiction.html"
               class="flex items-center gap-2 border-b-2 border-transparent transition duration-300 hover:text-purple-400 hover:border-purple-500 hover:scale-105 hover:bg-black/10 px-2 py-1 rounded-md">
                <i class="fas fa-meteor"></i> Fiction
            </a>
        </div>

        <div class="hidden sm:flex justify-end mr-4">
            <a href="index.html" class="text-gray-200 text-2xl hover:text-gray-400 transition flex items-center leading-none">
                <i class="fas fa-house" style="filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.6));"></i>
            </a>
        </div>

        <div id="dropdownMenu" class="dropdown hidden sm:hidden">
            <a href="horror.html"><i class="fas fa-mask mr-2"></i>Horror</a>
            <a href="comedy.html"><i class="fas fa-theater-masks mr-2"></i>Comedy</a>
            <a href="action.html"><i class="fas fa-person-running mr-2"></i>Action</a>
            <a href="fiction.html"><i class="fas fa-meteor mr-2"></i>Fiction</a>
        </div>
    </div>
</nav>

<section class="px-4 sm:px-8 lg:px-16">
    <h2 class="all-movie-header text-white text-3xl font-bold mb-4 tracking-wide text-center" style="padding-top: 6.5rem;">
        Find Your Movie
    </h2>
    <hr class="border-gray-400 mb-8 w-1/2 mx-auto">

    <div class="flex justify-center mb-8">
        <div class="flex items-center w-full max-w-md space-x-3">
            <input
                    type="text"
                    placeholder="Search movies..."
                    class="flex-grow rounded-full py-3 px-4 text-black bg-[#3c3d3c] placeholder-gray-100 focus:outline-none focus:ring-2 focus:ring-white"
            />
            <span class="text-gray-100 text-xl transition duration-200 hover:text-gray-500 hover:scale-110 cursor-pointer">
      <i class="fas fa-search"></i>
    </span>
        </div>
    </div>

    <div id="all-movies-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 movie">

    </div>
</section>

<script>
    const dropdownToggle = document.getElementById("dropdownToggle");
    const dropdownMenu = document.getElementById("dropdownMenu");
    const dropdownIcon = document.getElementById("dropdownIcon");

    dropdownToggle.addEventListener("click", () => {
        dropdownMenu.classList.toggle("hidden");

        if (dropdownMenu.classList.contains("hidden")) {
            dropdownIcon.classList.remove("fa-xmark");
            dropdownIcon.classList.add("fa-bars");
        } else {
            dropdownIcon.classList.remove("fa-bars");
            dropdownIcon.classList.add("fa-xmark");
        }
    });
</script>

<script>
    async function loadAllMovies() {
        const container = document.getElementById("all-movies-container");
        container.innerHTML = ''; // Clear old cards

        try {
            const res = await fetch("http://localhost:8080/api/movies");
            if (!res.ok) throw new Error("Failed to fetch movies");
            const movies = await res.json();

            movies.forEach(movie => {
                const releaseDate = new Date(movie.releaseDate).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });

                const cardHtml = `
  <article class="relative bg-gradient-to-br from-gray-900 via-black to-gray-900 rounded-2xl overflow-hidden border border-gray-700 shadow-2xl transform hover:scale-105 transition duration-300 flex flex-col backdrop-blur-sm h-80 min-w-[18rem]">
    <div class="relative w-full h-full rounded-2xl overflow-hidden">
      <img src="http://localhost:8080/uploads/${movie.imagePath}" alt="${movie.name}"
        class="w-full h-full object-cover brightness-75 hover:brightness-110 transition duration-500 ease-in-out" />
      <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent pointer-events-none"></div>
      <div class="absolute top-3 right-3 bg-green-500 text-black font-semibold px-3 py-1 rounded-md text-sm shadow-[0_0_8px_white]">
        ★ ${movie.rating.toFixed(1)}
      </div>
      <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/90 via-black/40 to-transparent p-4 rounded-b-2xl">
        <h3 class="text-2xl font-extrabold tracking-wide text-white drop-shadow-lg leading-snug">
          ${movie.name}
        </h3>
        <p class="text-green-400 uppercase font-semibold text-sm mt-1">
          ${movie.category}
        </p>
        <p class="text-gray-200 text-xs mt-1 italic">
          ${releaseDate}
        </p>
      </div>
    </div>
  </article>
`;


                container.innerHTML += cardHtml;
            });

        } catch (error) {
            console.error("Error loading movies:", error);
            container.innerHTML = '<p class="text-white text-center col-span-4">Failed to load movies.</p>';
        }
    }

    // Run on page load
    window.addEventListener('DOMContentLoaded', loadAllMovies);

    async function searchMovies(keyword) {
        const container = document.getElementById("all-movies-container");
        container.innerHTML = ''; // Clear current movies

        if (!keyword.trim()) {
            // If search box is empty, load all movies
            loadAllMovies();
            return;
        }

        try {
            const res = await fetch(`http://localhost:8080/api/movies/search?keyword=${encodeURIComponent(keyword)}`);
            if (!res.ok) throw new Error("Failed to fetch searched movies");
            const movies = await res.json();

            if (movies.length === 0) {
                container.innerHTML = '<p class="text-white text-center col-span-4">No movies found.</p>';
                return;
            }

            movies.forEach(movie => {
                const releaseDate = new Date(movie.releaseDate).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });

                const cardHtml = `
  <article class="relative bg-gradient-to-br from-gray-900 via-black to-gray-900 rounded-2xl overflow-hidden border border-gray-700 shadow-2xl transform hover:scale-105 transition duration-300 flex flex-col backdrop-blur-sm h-80 min-w-[18rem]">
    <div class="relative w-full h-full rounded-2xl overflow-hidden">
      <img src="http://localhost:8080/uploads/${movie.imagePath}" alt="${movie.name}"
        class="w-full h-full object-cover brightness-75 hover:brightness-110 transition duration-500 ease-in-out" />
      <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent pointer-events-none"></div>
      <div class="absolute top-3 right-3 bg-green-500 text-black font-semibold px-3 py-1 rounded-md text-sm shadow-[0_0_8px_white]">
        ★ ${movie.rating.toFixed(1)}
      </div>
      <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/90 via-black/40 to-transparent p-4 rounded-b-2xl">
        <h3 class="text-2xl font-extrabold tracking-wide text-white drop-shadow-lg leading-snug">
          ${movie.name}
        </h3>
        <p class="text-green-400 uppercase font-semibold text-sm mt-1">
          ${movie.category}
        </p>
        <p class="text-gray-200 text-xs mt-1 italic">
          ${releaseDate}
        </p>
      </div>
    </div>
  </article>
`;
                container.innerHTML += cardHtml;
            });

        } catch (error) {
            console.error("Error searching movies:", error);
            container.innerHTML = '<p class="text-white text-center col-span-4">Failed to search movies.</p>';
        }
    }

    // Select your search input (adjust selector if needed)
    const searchInput = document.querySelector('input[type="text"]');

    // Listen for input event to trigger search live
    searchInput.addEventListener('input', () => {
        searchMovies(searchInput.value);
    });

</script>

</body>
</html>
